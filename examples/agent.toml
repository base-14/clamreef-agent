[agent]
version = "1.0.0"
# machine_name = "my-server"  # Optional, auto-detected if not set
log_level = "info"

[telemetry]
endpoint = "http://localhost:4317"  # OTLP HTTP/JSON endpoint
interval_seconds = 60
timeout_seconds = 10
insecure = false
enabled = true  # Set to false to disable metrics export

[clamav]
# Unix socket (preferred on Linux/macOS)
socket_path = "/var/run/clamav/clamd.ctl"
# OR TCP connection
# tcp_host = "127.0.0.1"
# tcp_port = 3310
scan_timeout_seconds = 300

# Scan rules with cron-like scheduling
[[rules]]
name = "system_binaries"
paths = ["/usr/bin", "/usr/local/bin", "/opt/bin"]
schedule = "0 */6 * * *"  # Every 6 hours
exclude_patterns = ["*.log", "*.tmp", "*.cache"]
max_file_size = "100MB"
recursive = true
follow_symlinks = false

[[rules]]
name = "user_downloads"
paths = ["~/Downloads"]
schedule = "0 * * * *"  # Every hour
exclude_patterns = ["*.iso", "*.dmg", "*.zip"]
max_file_size = "1GB"
recursive = true
follow_symlinks = false

[[rules]]
name = "web_directories"
paths = ["/var/www", "/srv/http"]
schedule = "0 2 * * *"  # Daily at 2 AM
exclude_patterns = ["node_modules/", ".git/", "*.sock", "*.log"]
recursive = true
follow_symlinks = false

[[rules]]
name = "tmp_cleanup_scan"
paths = ["/tmp", "/var/tmp"]
schedule = "0 */4 * * *"  # Every 4 hours
exclude_patterns = ["systemd-*", ".X11-unix/"]
max_file_size = "50MB"
recursive = true
follow_symlinks = false