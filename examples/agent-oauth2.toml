# ClamReef Agent Configuration with OAuth2 Authentication
# This example demonstrates how to configure OAuth2 client credentials flow
# for authenticating with the OTLP collector endpoint

[agent]
version = "1.0.0"
log_level = "info"

[telemetry]
endpoint = "https://collector.example.com"  # OTLP HTTP/JSON endpoint (will append /v1/metrics)
interval_seconds = 30
timeout_seconds = 10
insecure = false
enabled = true  # Set to false to disable metrics export

# Configure OAuth2 authentication for telemetry endpoint
[telemetry.auth]
authenticator = "oauth2client"

# OAuth2 client credentials configuration
[oauth2client]
client_id = "your-client-id"
client_secret = "your-client-secret"
token_url = "https://your-identity-provider/realms/your-realm/protocol/openid-connect/token"

# Additional endpoint parameters (optional)
[oauth2client.endpoint_params]
audience = "your-audience"

[clamav]
socket_path = "/var/run/clamav/clamd.sock"
# Or use TCP connection:
# tcp_host = "127.0.0.1"
# tcp_port = 3310
scan_timeout_seconds = 300

# Freshclam configuration for automatic database updates
[freshclam]
enabled = true  # Set to false to disable automatic updates
schedule = "0 0 0 * * SUN"  # Once a week on Sunday at midnight (cron format)
reload_after_update = true  # Reload ClamAV daemon after successful update
path = "freshclam"  # Path to freshclam binary (default: "freshclam" from PATH, or specify full path like "/usr/bin/freshclam")

# Scan rules
[[rules]]
name = "system_scan"
paths = ["/usr/local/bin", "/opt"]
schedule = "0 */6 * * *"  # Every 6 hours
exclude_patterns = ["*.log", "*.tmp"]
max_file_size = "100MB"
recursive = true
follow_symlinks = false

[[rules]]
name = "home_scan"
paths = ["/home"]
schedule = "0 0 * * SUN"  # Weekly on Sunday
exclude_patterns = ["*.log", "*.cache", "node_modules/*"]
recursive = true
follow_symlinks = false
